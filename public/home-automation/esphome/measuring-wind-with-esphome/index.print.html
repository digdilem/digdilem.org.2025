<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="print">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="description" content="One very windy Autumn night, I wondered just how hard was the wind blowing? Spotting a cheap anenometer on Ebay, I figured it was worth trying to add this to my HA setup. It turned out to be surprisingly easy and in just an afternoon, things were up and working beautifully.
The WH1090 in-situ and working
The Physical Bits One Anenemeter, a HADEX WH1080. Although pretty much any pulse-based meter will work. It has two wires and putting a multimeter across them, I saw that one full revolution opens and closes these wires three times. Considering how fast these things can spin, that’s going to take a lot of counting! I extended the wiring by soldering and heat-shrinking a 5 meter length of bell wire onto it, then tested again. I mounted it on a shelf bracket with a suitable sized bolt that neatly screws into the mount, as i don’t have the full weather-station kit this unit comes with. This sits near my garage, although it’s not a great position since it’s quite sheltered. However, this is just a fun little project and I’m not too worried about its accuracy, and I won’t be sharing speeds with anyone else. One ESP8266 or ESP32 or similar chip. I’ve used a Nodemcu chip without any additional backboarding or hats. I put it in an old light-switch box just for some protection from knocks. Inside this scruffy thing lies the ESP8266, honest! Next time I’ll take better photos">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Measuring Wind With Esphome :: Digital Dilemma">
    <meta name="twitter:description" content="One very windy Autumn night, I wondered just how hard was the wind blowing? Spotting a cheap anenometer on Ebay, I figured it was worth trying to add this to my HA setup. It turned out to be surprisingly easy and in just an afternoon, things were up and working beautifully.
The WH1090 in-situ and working
The Physical Bits One Anenemeter, a HADEX WH1080. Although pretty much any pulse-based meter will work. It has two wires and putting a multimeter across them, I saw that one full revolution opens and closes these wires three times. Considering how fast these things can spin, that’s going to take a lot of counting! I extended the wiring by soldering and heat-shrinking a 5 meter length of bell wire onto it, then tested again. I mounted it on a shelf bracket with a suitable sized bolt that neatly screws into the mount, as i don’t have the full weather-station kit this unit comes with. This sits near my garage, although it’s not a great position since it’s quite sheltered. However, this is just a fun little project and I’m not too worried about its accuracy, and I won’t be sharing speeds with anyone else. One ESP8266 or ESP32 or similar chip. I’ve used a Nodemcu chip without any additional backboarding or hats. I put it in an old light-switch box just for some protection from knocks. Inside this scruffy thing lies the ESP8266, honest! Next time I’ll take better photos">
    <meta property="og:url" content="http://localhost:1313/home-automation/esphome/measuring-wind-with-esphome/index.html">
    <meta property="og:site_name" content="Digital Dilemma">
    <meta property="og:title" content="Measuring Wind With Esphome :: Digital Dilemma">
    <meta property="og:description" content="One very windy Autumn night, I wondered just how hard was the wind blowing? Spotting a cheap anenometer on Ebay, I figured it was worth trying to add this to my HA setup. It turned out to be surprisingly easy and in just an afternoon, things were up and working beautifully.
The WH1090 in-situ and working
The Physical Bits One Anenemeter, a HADEX WH1080. Although pretty much any pulse-based meter will work. It has two wires and putting a multimeter across them, I saw that one full revolution opens and closes these wires three times. Considering how fast these things can spin, that’s going to take a lot of counting! I extended the wiring by soldering and heat-shrinking a 5 meter length of bell wire onto it, then tested again. I mounted it on a shelf bracket with a suitable sized bolt that neatly screws into the mount, as i don’t have the full weather-station kit this unit comes with. This sits near my garage, although it’s not a great position since it’s quite sheltered. However, this is just a fun little project and I’m not too worried about its accuracy, and I won’t be sharing speeds with anyone else. One ESP8266 or ESP32 or similar chip. I’ve used a Nodemcu chip without any additional backboarding or hats. I put it in an old light-switch box just for some protection from knocks. Inside this scruffy thing lies the ESP8266, honest! Next time I’ll take better photos">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Measuring Wind With Esphome :: Digital Dilemma">
    <meta itemprop="description" content="One very windy Autumn night, I wondered just how hard was the wind blowing? Spotting a cheap anenometer on Ebay, I figured it was worth trying to add this to my HA setup. It turned out to be surprisingly easy and in just an afternoon, things were up and working beautifully.
The WH1090 in-situ and working
The Physical Bits One Anenemeter, a HADEX WH1080. Although pretty much any pulse-based meter will work. It has two wires and putting a multimeter across them, I saw that one full revolution opens and closes these wires three times. Considering how fast these things can spin, that’s going to take a lot of counting! I extended the wiring by soldering and heat-shrinking a 5 meter length of bell wire onto it, then tested again. I mounted it on a shelf bracket with a suitable sized bolt that neatly screws into the mount, as i don’t have the full weather-station kit this unit comes with. This sits near my garage, although it’s not a great position since it’s quite sheltered. However, this is just a fun little project and I’m not too worried about its accuracy, and I won’t be sharing speeds with anyone else. One ESP8266 or ESP32 or similar chip. I’ve used a Nodemcu chip without any additional backboarding or hats. I put it in an old light-switch box just for some protection from knocks. Inside this scruffy thing lies the ESP8266, honest! Next time I’ll take better photos">
    <meta itemprop="datePublished" content="2025-06-21T15:18:14+01:00">
    <meta itemprop="dateModified" content="2025-06-21T15:18:14+01:00">
    <meta itemprop="wordCount" content="932">
    <meta itemprop="keywords" content="Home-Assistant,Anenometer,Esphome,Wind,Measuring">
    <title>Measuring Wind With Esphome :: Digital Dilemma</title>
    <link href="http://localhost:1313/home-automation/esphome/measuring-wind-with-esphome/index.html" rel="canonical" type="text/html" title="Measuring Wind With Esphome :: Digital Dilemma">
    <link href="/home-automation/esphome/measuring-wind-with-esphome/index.xml" rel="alternate" type="application/rss+xml" title="Measuring Wind With Esphome :: Digital Dilemma">
    <link href="/home-automation/esphome/measuring-wind-with-esphome/index.source.md" rel="alternate" type="text/markdown" title="Measuring Wind With Esphome :: Digital Dilemma">
    <link href="/images/favicon.png?1750708794" rel="icon" type="image/png">
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1750708794" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1750708794" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1750708794" rel="stylesheet">
    <link href="/css/theme.css?1750708794" rel="stylesheet">
    <link href="/css/format-print.css?1750708794" rel="stylesheet" id="R-format-style">
    <link href="/css/auto-complete/auto-complete.min.css?1750708794" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1750708794" defer></script>
    <script src="/js/lunr/lunr.min.js?1750708794" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1750708794" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1750708794" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1750708794" defer></script>
    <script src="/js/search.js?1750708794" defer></script>
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = ``;
      window.relearn.path='\/home-automation\/esphome\/measuring-wind-with-esphome\/index.html';
      window.relearn.relBasePath='..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.contentLangs=['en'];
      window.relearn.index_js_url="/searchindex.en.js?1750708794";
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=false;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // variant stuff
      window.relearn.themevariants = [ 'auto' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script><style>
:root {
    --MAIN-WIDTH-MAX: 1000rem;
}
</style>


  </head>
  <body class="mobile-support print" data-url="/home-automation/esphome/measuring-wind-with-esphome/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#the-physical-bits">The Physical Bits</a></li>
    <li><a href="#connecting-the-bits">Connecting the bits</a></li>
    <li><a href="#the-esphome-code">The ESPHome code</a></li>
    <li><a href="#one-last-thing">One last thing!</a></li>
    <li><a href="#home-assistant">Home Assistant</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList">
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/index.html"><span itemprop="name">Digital Dilemma</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li>
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/home-automation/index.html"><span itemprop="name">Home Automation</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li>
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/home-automation/esphome/index.html"><span itemprop="name">Esphome</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li>
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Measuring Wind With Esphome</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-source" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/home-automation/esphome/measuring-wind-with-esphome/index.source.md" title="Show source code"><i class="fa-fw fas fa-code"></i></a>
            </div>
            <div class="topbar-button topbar-button-print" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/home-automation/esphome/measuring-wind-with-esphome/index.print.html" title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/home-automation/esphome/measuring-voltage-with-an-esp32/index.html" title="Measuring Voltage With an Esp32 (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/home-automation/esphome/one-wire/index.html" title="Using One Wire sensors in ESPHome (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable home-automation" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="measuring-wind-with-esphome">Measuring Wind With Esphome</h1>

<p>One very windy Autumn night, I wondered just how hard was the wind blowing? Spotting a cheap anenometer on Ebay, I figured it was worth trying to add this to my HA setup. It turned out to be surprisingly easy and in just an afternoon, things were up and working beautifully.</p>
<p>

  


<figure>
  <img src="1.png"
       alt="The WH1090 in-situ and working"
       
       loading="lazy"
       decoding="async"
  >
  
    <figcaption><p><b><i>The WH1090 in-situ and working</b></i></p></figcaption>
  
</figure>
</p>
<h2 id="the-physical-bits">The Physical Bits</h2>
<ul>
<li>One Anenemeter, a HADEX WH1080.
<ul>
<li>Although pretty much any pulse-based meter will work.</li>
<li>It has two wires and putting a multimeter across them, I saw that one full revolution opens and closes these wires three times. Considering how fast these things can spin, that’s going to take a lot of counting!</li>
<li>I extended the wiring by soldering and heat-shrinking a 5 meter length of bell wire onto it, then tested again.</li>
<li>I mounted it on a shelf bracket with a suitable sized bolt that neatly screws into the mount, as i don’t have the full weather-station kit this unit comes with. This sits near my garage, although it’s not a great position since it’s quite sheltered. However, this is just a fun little project and I’m not too worried about its accuracy, and I won’t be sharing speeds with anyone else.</li>
</ul>
</li>
<li>One ESP8266 or ESP32 or similar chip.
<em>I’ve used a Nodemcu chip without any additional backboarding or hats. I put it in an old light-switch box just for some protection from knocks.</em></li>
</ul>
<p>

  


<figure>
  <img src="2.png"
       alt="Inside this scruffy thing lies the ESP8266, honest! Next time I’ll take better photos"
       
       loading="lazy"
       decoding="async"
  >
  
    <figcaption><p><b><i>Inside this scruffy thing lies the ESP8266, honest! Next time I’ll take better photos</b></i></p></figcaption>
  
</figure>
</p>
<h2 id="connecting-the-bits">Connecting the bits</h2>
<p>The ESP8266 connects to HA by wifi, so it only needs a USB power supply and whatever connections we’re poking into it.</p>
<p>The Anenometer has two wires, and they open and close three times per revolution. It shouldn’t matter which way around they are connecting as we only care that they open and close.</p>
<p>I connected these to pins GND and GPIO14 next to it (which is Pin D4 on the board) – see this useful reference for the NodemCPU to figure out which pins go where.</p>
<p>That’s it! One micro usb connector supplying 5v and two wires.</p>
<h2 id="the-esphome-code">The ESPHome code</h2>
<p>(I won’t cover the ‘Getting started’ bit of ESPhome – they have their own excellent documentation <a href="https://esphome.io/" rel="external" target="_blank">here</a>)</p>
<p>Before I placed the ESP8266 in position, I connected it to a small Linux PC via USB and did this;</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mkdir -p /opt/esphome/anenometer
cd /opt/esphome/anenomter
esphome wizard configuration anenometer.yaml</code></pre></div>
<p>This creates a directory for the files and changes into it, then sets up the initial yaml file for the project. Once you’ve answered some basic questions, you’re can then edit the anenometer.yaml file with the editor of your choice. (I use vi, but you do whatever you like)</p>
<p>This is what my anenometer.yaml file looks like once I’ve added in some bits</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>esphome:
  name: anenometer
  platform: ESP8266
  board: nodemcu

# Enable logging
logger:

# Enable Home Assistant API
api:
  password: &#34;&#34;

ota:
  password: &#34;&#34;

wifi:
  ssid: &#34;HOMESSID&#34;
  password: &#34;PASSWORD&#34;

  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: &#34;Anenometer Fallback Hotspot&#34;
    password: &#34;PASSWORD&#34;

captive_portal:

sensor:
  - platform: pulse_meter
    pin:
      number: GPIO14
      mode: INPUT_PULLUP
    name: &#39;Windspeed Meter&#39;
    icon: &#39;mdi:weather-windy&#39;
    id: wind_meter
    unit_of_measurement: &#39;mph&#39;
    accuracy_decimals: 0
    timeout: 5s
    filters:
      - multiply: 0.0015    
      - sliding_window_moving_average:
          window_size: 100
          send_every: 100</code></pre></div>
<p>Now, to explain some of the sensor bits here that might not be self-evident:</p>
<ul>
<li><strong>Name</strong>: What Home Assistant will call this entity.</li>
<li><strong>filters</strong>:
<ul>
<li><strong>multiply</strong>: This is where the trial and error comes in. At this stage, I’m guessing as I have no other point of reference, but this seems roughly to match the Beaufort Scale over the past few days. Do experiment with this value yourself. (The fact this is less than 1 means the multiplication is actually a division)</li>
<li><strong>sliding_window_moving_average</strong>: This allows us to count a bunch of pulses and then send a value every N number. Without this we would be trying to send every pulse, and as each rotate is three pulses, that might not be so good.</li>
<li><strong>window_size</strong>: How many pulses to read before establishing an average number over that time. This could be much larger to eliminate gusts, but it would be much slower to update in non-windy conditions.</li>
<li><strong>send_every</strong>: How many pulses are received before sending an update to HA.</li>
</ul>
</li>
</ul>
<p>Again, Esphome has better and accurate documentation on each of these items <a href="https://esphome.io/components/sensor/index.html" rel="external" target="_blank">here</a></p>
<p>That’s about it! The config was first uploaded to the ESP8266 using esphome run anenometer.yaml and then choosing the right-looking USB port.</p>
<p>Once it’s up though, you can change this file and update the ESP8266 over the air by re-running the same command and choosing “Over the air” instead of selecting a USB port. Magic!</p>
<h2 id="one-last-thing">One last thing!</h2>
<p>You’ll need to know what IP address your new ESP8266 was given. I find this out by checking my router’s DHCP list, but you can also use arpwatch to look for new devices.</p>
<h2 id="home-assistant">Home Assistant</h2>
<p>To add the new ESP8266 device to HA, we need to</p>
<ul>
<li>Go into Settings -&gt; Devices &amp; Services in Home Assistant</li>
<li>Click Add Integration</li>
<li>Select ESPHome</li>
<li>Enter the IP Address of your new ESP8266 (See ‘One Last Thing!’ above) and leave the default port of 6053 as it is. Click Submit.</li>
<li>Your new device should appear in the ESPhome panel on the Integrations page, and selecting it will show it has one entity – which should be called Windspeed and have the entity id of sensor.windspeed_meter</li>
<li>Clicking on that entry, and into the Info tab should show some data, and after a little while, look something like this</li>
</ul>
<p>

  


<figure>
  <img src="3.png"
       alt="My windspeed graph"
       
       loading="lazy"
       decoding="async"
  >
  
    <figcaption><p><b><i>My windspeed graph</b></i></p></figcaption>
  
</figure>
</p>
<p>And that’s it! You can add it to any dashboards you like.</p>

  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Jun 21, 2025
<div class="R-taxonomy taxonomy-categories cstyle" title="Categories" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <i class="fa-fw fas fa-layer-group"></i>
  <ul>
    <li><a class="term-link" href="/categories/anenometer/index.html">Anenometer</a></li>
    <li><a class="term-link" href="/categories/esphome/index.html">Esphome</a></li>
    <li><a class="term-link" href="/categories/home-assistant/index.html">Home-Assistant</a></li>
    <li><a class="term-link" href="/categories/measuring/index.html">Measuring</a></li>
    <li><a class="term-link" href="/categories/wind/index.html">Wind</a></li>
  </ul>
</div>
  </footer>
</article>
        </div>
      </main>
    </div>
    <script src="/js/clipboard/clipboard.min.js?1750708794" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1750708794" defer></script>
    <script src="/js/theme.js?1750708794" defer></script>
  </body>
</html>
